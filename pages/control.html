<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title></title>
        <link rel="stylesheet" type="text/css" href="../static/css/WhiteS.css"/>
        <link rel="stylesheet" type="text/css" href="../static/css/main.css"/>
        <script src="../static/js/jquery-3.3.1.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../static/js/WhiteS.js" type="text/javascript" charset="utf-8"></script>
	</head>
	<body>
        <div class="main-box ">
            <div class="main" style="margin:0 50px;width:100%">
                <div id="app-table">
                    <div class="table">
                        <table id="testTable" border="0">
                        	<tr class="table-tr">
                        	    <th>公司名称</th>
                        	    <th>介绍</th>
                        	    <th>联系电话</th>
                        	    <th>地址</th>
                        	    <th>登录用户名</th>
                        	    <th>操作</th>
                        	</tr>
                        </table>
                    </div>
                </div>
                <div class="page-box">
                    <div class="page-box-click">
                        首页
                    </div>
                    <div class="page-box-click">
                        上一页
                    </div>
                    <div class="">
                        共10页
                    </div>
                    <div class="">
                        当前为第 5 页
                    </div>
                    <div class="page-box-click">
                        下一页
                    </div>
                    <div class="page-box-click">
                        最后一页
                    </div>
                </div>
            </div>
        </div>
	</body>
    <script type="text/javascript">
        let wcontent = '';
        for(let x =0 ;x<100;x++){
            wcontent+=`
            <tr class="table-tr">
                <td>关东税有限公司</td>
                <td>介绍介绍介绍介绍介绍介绍介绍</td>
                <td>020-59632584</td>
                <td>北京市朝阳区</td>
                <td>登录用户名</td>
                <td>
                    <span class="table-btn">信息修改</span>
                    <span class="table-btn" onclick="showLoginInfo(this)">登录日志</span>
                    <br/>
                    <span class="table-btn" onclick="passwordReset(this)">密码重置</span>
                    <span class="table-btn" onclick="showInterfaceInfo(this)">接口日志</span>
                </td>
            </tr>`
        }
        document.querySelector('#testTable').innerHTML = document.querySelector('#testTable').innerHTML+wcontent;
        //控制出现的表格隐藏内容
        function selectTableTr(dom){
            let meDom = $(dom);
            let meDomParent = meDom.parents('tr');
            if(meDom.hasClass('table-sidecon-btn-select')){
                //表示为开启状态
                meDom.removeClass('table-sidecon-btn-select');
                meDomParent.next().css('display','none');
            }else{
                //表示为关闭状态
                meDom.addClass('table-sidecon-btn-select');
                meDomParent.next().css('display','');
            }
        }
        //打开登录日志
        function showLoginInfo(dom){
            let content = '';
            for(let x =0 ;x<300;x++){
                content+=`
                <tr class="table-tr">
                    <td>关东税有限公司</td>
                    <td>介绍介绍介绍介绍介绍介绍介绍</td>
                    <td>020-59632584</td>
                    <td>北京市朝阳区</td>
                    <td>登录用户名</td>
                    <td><span class="table-sidecon-btn input-img-fx" onclick="selectTableTr(this)"></span></td>
                </tr>
                <tr class="table-tr" style="display:none">
                    <td  colspan="6">
                        <div class="table-sidecon-content">
                            <div class="table-sidecon-content-left">
                                <div class="table-sidecon-content-title">请求参数</div>
                                    <pre>
                                        {
                                            a:"123",
                                            b:[
                                                b-1:"b-1",
                                                b-2:"b-2",
                                                b-3:"b-3",
                                            ]
                                        }
                                    </pre>
                            </div>
                            <div class="table-sidecon-content-right">
                                <div class="table-sidecon-content-title">返回参数</div>
                                    <pre>
                                        {
                                            a:"123",
                                            b:[
                                                b-1:"b-1",
                                                b-2:"b-2",
                                                b-3:"b-3",
                                            ]
                                        }
                                    </pre>
                            </div>
                        <div>
                    </td>
                </tr>
                `
            }
            //初始化侧边标签栏
            $ws.sidecon.init();
            let uuid = $ws.sidecon.add({
                title:"测试有限公司-登录日志",
                id:dom._id,
                content:`
                    <div id="app-table">
                        <div class="table">
                            <table border="0">
                            	<tr class="table-tr">
                            	    <th>公司名称</th>
                            	    <th>介绍</th>
                            	    <th>联系电话</th>
                            	    <th>地址</th>
                            	    <th>登录用户名</th>
                                    <th>操作</th>
                            	</tr>
                                ${content}
                            </table>
                        </div>
                    </div>
                    <div class="page-box">
                        <div class="page-box-click">
                            首页
                        </div>
                        <div class="page-box-click">
                            上一页
                        </div>
                        <div class="">
                            共10页
                        </div>
                        <div class="">
                            当前为第 5 页
                        </div>
                        <div class="page-box-click">
                            下一页
                        </div>
                        <div class="page-box-click">
                            最后一页
                        </div>
                    </div>
                `
            });
            //添加唯一标识符
            dom._id = uuid;
        }
        //打开接口日志
        function showInterfaceInfo(dom){
            let content = '';
            for(let x =0 ;x<300;x++){
                content+=`
                <tr class="table-tr">
                    <td>关东税有限公司</td>
                    <td>介绍介绍介绍介绍介绍介绍介绍</td>
                    <td>020-59632584</td>
                    <td>北京市朝阳区</td>
                    <td>登录用户名</td>
                </tr>`
            }
            //初始化侧边标签栏
            $ws.sidecon.init();
            let uuid = $ws.sidecon.add({
                title:"测试有限公司-接口日志",
                id:dom._id,
                content:`
                    <div id="app-table">
                        <div class="table">
                            <table border="0">
                            	<tr class="table-tr">
                            	    <th>公司名称</th>
                            	    <th>介绍</th>
                            	    <th>联系电话</th>
                            	    <th>地址</th>
                            	    <th>登录用户名</th>
                            	</tr>
                                ${content}
                            </table>
                        </div>
                    </div>
                    <div class="page-box">
                        <div class="page-box-click">
                            首页
                        </div>
                        <div class="page-box-click">
                            上一页
                        </div>
                        <div class="">
                            共10页
                        </div>
                        <div class="">
                            当前为第 5 页
                        </div>
                        <div class="page-box-click">
                            下一页
                        </div>
                        <div class="page-box-click">
                            最后一页
                        </div>
                    </div>
                `
            });
            //添加唯一标识符
            dom._id = uuid;
        }
        //点击密码重置
        function passwordReset(){
            $ws.modal({
                headText: '密码重置',
                confirmText: '确定修改',
                content: `
                <div class="login-row">
                    公司名称：关东税有限公司
                </div>
                <div class="login-row">
                   登录用户名：G0001
                </div>
                <div class="login-row">
                    <div class="ws-input-text">
                        <div class="ws-input-left input-img-st"></div>
                        <input type="password" placeholder="请输入密码" id="p-pwd"/>
                        <label class="ws-input-box"></label>
                    </div>
                </div>
                `,
                onConfirm(e) {
                    //判断数据是否存在问题
                    let pwd = $('#p-pwd').val();
                    if (pwd.length == 0) {
                        $ws.toast('请输入当前密码', 'error');
                        return
                    }
                    $ws.ajax({
                        url: "../User/ModifyPsw",
                        data: {
                            OldPsw: pwd,
                        },
                        success() {
                            e.close();
                            $ws.toast('密码修改成功，请重新登录', {
                                callback: function() {
                                    window.location.href = "../user/index";
                                }
                            });
                        }
                    });
                }
            });
        }
    </script>
</html>
